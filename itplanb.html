<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6214772877334340"
     crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çŸ³æ²¹å…¬å¸ 2000: ITæ„¿æ™¯äº¤äº’å¼ä½“éªŒ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chosen Palette: Windows 2000 Classic -->
    <!-- Application Structure Plan: The application is designed as a simulation of the Windows 2000 desktop environment. This "digital archaeology" or "desktop metaphor" approach was chosen to create an immersive and contextually rich experience, directly transporting the user back to the era of the report. Instead of a linear scroll, the user explores content through familiar desktop interactions: clicking icons ('My Computer', 'My Documents', 'Intranet Explorer') which open draggable, resizable "windows". This non-linear, discovery-based flow encourages exploration and makes the dense report content more engaging and digestible. Each icon logically maps to a core theme of the report (e.g., 'My Computer' for Infrastructure, 'SAP Login' for ERP/EAI), providing an intuitive information architecture that leverages the user's existing mental models of a desktop OS. -->
    <!-- Visualization & Content Choices: 
        - Report Info: Strategic Initiatives (Budgets/Timelines). Goal: Compare resource allocation. Viz Method: Horizontal Bar Chart (Chart.js). Interaction: Tooltips on hover provide exact figures. Justification: Bar charts are excellent for comparing discrete categories. Library: Chart.js (Canvas).
        - Report Info: EAI Architecture (Hub-and-Spoke). Goal: Organize system relationships. Viz Method: HTML/CSS Diagram. Interaction: Hovering over elements reveals descriptive tooltips. Justification: A static, styled HTML diagram is sufficient and avoids complex SVG, clearly illustrating the architectural concept. Library/Method: Tailwind CSS.
        - Report Info: 2000 vs 2025 Tech Comparison. Goal: Compare across time. Viz Method: Tabulated text in a two-column layout. Interaction: A "Future View" button toggles the visibility of the 2025 column. Justification: Simple, direct comparison is most effective for textual data. Library/Method: Vanilla JS + Tailwind.
        - Report Info: Core Report Content (Text). Goal: Inform. Viz Method: Formatted text within draggable windows. Interaction: Users can open, close, drag, and resize windows to manage their "workspace". Justification: This mimics the real OS experience and gives users control over information presentation. Library/Method: Vanilla JS + Tailwind.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&display=swap');
        
        body {
            font-family: 'Tahoma', 'Noto Sans SC', sans-serif;
            background-color: #008080;
            overflow: hidden;
            user-select: none;
        }

        .desktop {
            width: 100vw;
            height: 100vh;
            background: url('https://placehold.co/1920x1080/005353/FFFFFF?text=PetroCorp+2000') center/cover;
            position: relative;
        }

        .taskbar {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 30px;
            background-color: #C0C0C0;
            border-top: 2px solid #FFFFFF;
            box-shadow: inset 0 1px 0 #808080;
            display: flex;
            align-items: center;
            z-index: 1000;
        }

        .start-button {
            background-color: #C0C0C0;
            border: 2px outset #FFFFFF;
            box-shadow: inset 1px 1px 0 #FFFFFF, inset -1px -1px 0 #808080;
            padding: 0 8px;
            display: flex;
            align-items: center;
            height: 24px;
            margin-left: 2px;
            cursor: pointer;
        }
        .start-button:active {
            border-style: inset;
        }
        .start-button img {
            width: 16px;
            height: 16px;
            margin-right: 4px;
        }
        .start-button span {
            font-weight: bold;
        }

        .clock {
            margin-left: auto;
            border: 1px inset #808080;
            padding: 2px 8px;
            margin-right: 4px;
            font-size: 12px;
        }

        .desktop-icon {
            position: absolute;
            width: 80px;
            text-align: center;
            color: white;
            padding: 4px;
            cursor: pointer;
            border: 1px solid transparent;
        }
        .desktop-icon:hover {
            background-color: rgba(0, 0, 128, 0.5);
            border: 1px dotted #FFFFFF;
        }
        .desktop-icon img {
            width: 48px;
            height: 48px;
            margin: 0 auto;
        }
        .desktop-icon p {
            font-size: 12px;
            margin-top: 4px;
            text-shadow: 1px 1px 2px black;
        }

        .window {
            position: absolute;
            background-color: #C0C0C0;
            border: 2px outset #FFFFFF;
            box-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            min-width: 320px;
            min-height: 200px;
            resize: both;
            overflow: hidden;
            display: none; /* Hidden by default */
        }
        .window.active {
            z-index: 500;
        }

        .title-bar {
            background: linear-gradient(to right, #000080, #1084d0);
            color: white;
            padding: 3px 5px;
            font-weight: bold;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
            height: 24px;
        }

        .title-bar-buttons {
            display: flex;
        }
        .title-bar-button {
            width: 16px;
            height: 14px;
            background-color: #C0C0C0;
            border: 1px outset #FFFFFF;
            margin-left: 2px;
            font-family: 'Marlett', 'Noto Sans SC', sans-serif;
            font-size: 10px;
            text-align: center;
            line-height: 12px;
            cursor: pointer;
        }
        .title-bar-button:active {
            border-style: inset;
        }

        .window-body {
            padding: 10px;
            background-color: #FFFFFF;
            flex-grow: 1;
            overflow-y: auto;
            font-size: 14px;
            color: #000;
        }
        
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        .future-view-button {
            background: linear-gradient(to right, #4f46e5, #818cf8);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .future-view-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    <div id="desktop" class="desktop">
        <!-- Desktop Icons -->
        <div id="icon-intranet" class="desktop-icon" style="top: 30px; left: 30px;">
            <img src="https://placehold.co/48x48/C0C0C0/000000?text=ğŸŒ" alt="Intranet Explorer">
            <p>å†…ç½‘æµè§ˆå™¨</p>
        </div>
        <div id="icon-sap" class="desktop-icon" style="top: 130px; left: 30px;">
            <img src="https://placehold.co/48x48/C0C0C0/000000?text=âš™ï¸" alt="SAP Login">
            <p>SAP ç™»å½•</p>
        </div>
        <div id="icon-docs" class="desktop-icon" style="top: 230px; left: 30px;">
            <img src="https://placehold.co/48x48/C0C0C0/000000?text=ğŸ“„" alt="My Documents">
            <p>æˆ‘çš„æ–‡æ¡£</p>
        </div>
    </div>

    <!-- Taskbar -->
    <div class="taskbar">
        <div class="start-button">
            <img src="https://placehold.co/16x16/000080/FFFFFF?text=P" alt="Start">
            <span>å¼€å§‹</span>
        </div>
        <div class="clock" id="clock"></div>
    </div>

    <!-- Windows -->
    <div id="window-intranet" class="window" style="top: 50px; left: 150px; width: 700px; height: 500px;">
        <div class="title-bar">
            <span>å†…ç½‘æµè§ˆå™¨ - PetroCorp 2000 æ„¿æ™¯</span>
            <div class="title-bar-buttons">
                <div class="title-bar-button close-button">r</div>
            </div>
        </div>
        <div class="window-body">
            <h1 class="text-2xl font-bold text-blue-800 mb-4">æ–°åƒå¹´æ›™å…‰ä¸‹çš„ITä¸–ç•Œ</h1>
            <p class="mb-4">æ¬¢è¿è®¿é—®PetroCorpå…¬å¸å†…ç½‘ã€‚2000å¹´ï¼Œå¯¹äºå…¨çƒITç•Œè€Œè¨€ï¼Œæ˜¯ä¸€ä¸ªå……æ»¡çŸ›ç›¾ä¸å¸Œæœ›çš„ç‹¬ç‰¹å¹´ä»½ã€‚æˆ‘ä»¬åˆšåˆšè€—è´¹å·¨èµ„æˆåŠŸè§„é¿äº†â€œåƒå¹´è™«â€å±æœºï¼Œæ—‹å³åˆè¢«å·å…¥äº’è”ç½‘æ³¡æ²«çš„ç‹‚çƒ­æµªæ½®ã€‚è¿™ç§ç”±ææƒ§é©±åŠ¨çš„å¤§è§„æ¨¡ITç›˜ç‚¹ï¼Œä¸éç†æ€§ç¹è£å‚¬ç”Ÿçš„å·¨é¢æŠ•èµ„ç›¸ç»“åˆï¼Œä¸ºæˆ‘ä»¬åˆ¶å®šITæˆ˜ç•¥åˆ›é€ äº†ä¸€ä¸ªå‰æ‰€æœªæœ‰çš„å®è§‚ç¯å¢ƒã€‚æœ¬é—¨æˆ·æ—¨åœ¨é˜æ˜å…¬å¸åœ¨è¿™ä¸€å…³é”®æ—¶åˆ»çš„ä¸šåŠ¡é©±åŠ¨åŠ›ä¸é¢ä¸´çš„æŒ‘æˆ˜ã€‚</p>
            
            <div class="bg-gray-100 p-4 rounded-lg border border-gray-300">
                <h2 class="text-xl font-bold text-blue-700 mb-2">PetroCorpçš„æˆ˜ç•¥è¦åŠ¡</h2>
                <p class="mb-2">ä½œä¸ºä¸€å®¶å…¨çƒèƒ½æºå·¨å¤´ï¼Œæˆ‘ä»¬çš„ITè½¬å‹ä¸ä»…æ˜¯è¿½èµ¶æ½®æµï¼Œæ›´æ˜¯å…³ä¹ç”Ÿå­˜å’Œå‘å±•çš„æˆ˜ç•¥è¦åŠ¡ã€‚æˆ‘ä»¬é¢ä¸´ä¸‰å¤§æ ¸å¿ƒæŒ‘æˆ˜ï¼š</p>
                <ul class="list-disc list-inside space-y-2">
                    <li><strong>åº”å¯¹ä»·æ ¼æ³¢åŠ¨ä¸å…¨çƒåŒ–è¿è¥ï¼š</strong> çŸ³æ²¹è¡Œä¸šå¤©ç„¶å…·æœ‰å‘¨æœŸæ€§ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨æŠ€æœ¯æå‡æ•ˆç‡ã€é™ä½æˆæœ¬ï¼Œå¹¶å®ç°å¯¹å…¨çƒåè¿œèµ„äº§çš„æœ‰æ•ˆç›‘æ§ã€‚</li>
                    <li><strong>â€œå¤§æ¢ç­â€ï¼š</strong> å¤§æ‰¹ç»éªŒä¸°å¯Œçš„å·¥ç¨‹å¸ˆå³å°†é€€ä¼‘ï¼Œæˆ‘ä»¬å¿…é¡»é€šè¿‡â€œçŸ¥è¯†ç®¡ç†â€æ¥æ•è·å’Œä¼ æ‰¿ä»–ä»¬å®è´µçš„éšæ€§çŸ¥è¯†ï¼Œé˜²æ­¢æ ¸å¿ƒçŸ¥è¯†èµ„äº§æµå¤±ã€‚</li>
                    <li><strong>æ•°æ®æŒ‡ä»¤ï¼š</strong> ä»æµ·é‡çš„åœ°éœ‡å‹˜æ¢æ•°æ®åˆ°ç®¡é“çš„å®æ—¶è¿è¥æ•°æ®ï¼Œæˆ‘ä»¬å¿…é¡»æ‰“ç ´â€œä¿¡æ¯å­¤å²›â€ï¼Œæœ‰æ•ˆæ•´åˆä¸åˆ©ç”¨è¿™äº›æ•°æ®ï¼Œä»¥æ”¯æŒæ›´ç²¾å‡†çš„å†³ç­–ã€‚</li>
                </ul>
            </div>
        </div>
    </div>

    <div id="window-sap" class="window" style="top: 100px; left: 250px; width: 650px; height: 480px;">
        <div class="title-bar">
            <span>ä¼ä¸šåº”ç”¨é›†æˆ (EAI) æ¶æ„</span>
            <div class="title-bar-buttons">
                <div class="title-bar-button close-button">r</div>
            </div>
        </div>
        <div class="window-body">
            <h1 class="text-2xl font-bold text-blue-800 mb-4">é›†æˆåŒ–ä¼ä¸šï¼šç”¨ERPå’ŒEAIé©¯æœå¤æ‚æ€§</h1>
            <p class="mb-4">ä¸ºäº†æ‰“ç ´ä¿¡æ¯å­¤å²›ï¼Œæˆ‘ä»¬çš„æ ¸å¿ƒæˆ˜ç•¥æ˜¯å®æ–½SAP R/3ç³»ç»Ÿï¼Œä»¥ç»Ÿä¸€è´¢åŠ¡ã€äººäº‹ã€ä¾›åº”é“¾ç­‰æ ¸å¿ƒä¸šåŠ¡ã€‚ç„¶è€Œï¼Œæ²¡æœ‰ä»»ä½•ä¸€ä¸ªç³»ç»Ÿèƒ½æ»¡è¶³æ‰€æœ‰éœ€æ±‚ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é‡‡ç”¨â€œä¼ä¸šåº”ç”¨é›†æˆâ€ï¼ˆEAIï¼‰æŠ€æœ¯ï¼Œå°†SAPè¿™ä¸ªåºç„¶å¤§ç‰©ä¸æ•°ç™¾ä¸ªå…¶ä»–å…³é”®åº”ç”¨ï¼ˆå¦‚åœ°çƒç§‘å­¦è½¯ä»¶ã€SCADAç³»ç»Ÿï¼‰è¿æ¥èµ·æ¥ã€‚</p>
            
            <h2 class="text-lg font-bold mt-6 mb-2 text-center">è½®è¾å¼ (Hub-and-Spoke) EAI æ¶æ„</h2>
            <div class="flex justify-center items-center p-4 bg-gray-100 rounded-lg border border-gray-300">
                 <div class="relative w-full max-w-lg h-64 flex items-center justify-center">
                    <div class="absolute w-24 h-24 bg-blue-600 text-white rounded-full flex items-center justify-center text-center font-bold shadow-lg" title="ä¸­å¿ƒçš„é›†æˆä»£ç†ï¼Œè´Ÿè´£ç®¡ç†æ‰€æœ‰é€šä¿¡ã€‚">EAI<br>é›†æˆä¸­å¿ƒ</div>
                    <div class="absolute top-0 left-1/2 -ml-8 w-16 text-center">
                        <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center text-white font-bold shadow-md" title="åœ°çƒç§‘å­¦è½¯ä»¶">å‹˜æ¢</div>
                    </div>
                     <div class="absolute bottom-0 left-1/2 -ml-8 w-16 text-center">
                        <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center text-white font-bold shadow-md" title="ä¾›åº”é“¾ç®¡ç†ç³»ç»Ÿ">SCM</div>
                    </div>
                     <div class="absolute left-0 top-1/2 -mt-8 h-16 text-center">
                        <div class="w-16 h-16 bg-red-500 rounded-full flex items-center justify-center text-white font-bold shadow-md" title="æ ¸å¿ƒERPç³»ç»Ÿ">SAP R/3</div>
                    </div>
                     <div class="absolute right-0 top-1/2 -mt-8 h-16 text-center">
                        <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center text-white font-bold shadow-md" title="å®æ—¶è¿‡ç¨‹ç›‘æ§ç³»ç»Ÿ">SCADA</div>
                    </div>
                </div>
            </div>
             <p class="text-sm text-center mt-2 text-gray-600">ä¸€ä¸ªä¸­å¿ƒçš„â€œé›†æˆä»£ç†â€è´Ÿè´£ç®¡ç†æ‰€æœ‰å¤–å›´åº”ç”¨ï¼ˆâ€œè¾æ¡â€ï¼‰ä¹‹é—´çš„é€šä¿¡ï¼Œå¤§å¤§ç®€åŒ–äº†é›†æˆçš„å¤æ‚æ€§ã€‚</p>
        </div>
    </div>

    <div id="window-docs" class="window" style="top: 150px; left: 350px; width: 800px; height: 600px;">
        <div class="title-bar">
            <span>æˆ‘çš„æ–‡æ¡£ - PetroCorp æˆ˜ç•¥è®¡åˆ’</span>
            <div class="title-bar-buttons">
                <div class="title-bar-button close-button">r</div>
            </div>
        </div>
        <div class="window-body">
            <h1 class="text-2xl font-bold text-blue-800 mb-4">æ–°åƒå¹´çš„æˆ˜ç•¥ä¸¾æª</h1>
            <p class="mb-6">æˆ‘ä»¬å°†å®è§‚æ„¿æ™¯è½¬åŒ–ä¸ºä¸€ç³»åˆ—å…·ä½“çš„ã€å¯æ‰§è¡Œçš„æˆ˜ç•¥æ€§ITé¡¹ç›®ç»„åˆã€‚æ¯ä¸ªé¡¹ç›®éƒ½æœ‰æ˜ç¡®çš„ç›®æ ‡ã€é¢„ç®—å’Œæ—¶é—´è¡¨ï¼Œå…±åŒæ„æˆäº†æˆ‘ä»¬è¿ˆå‘æœªæ¥çš„æ•°å­—è“å›¾ã€‚</p>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                    <h2 class="text-xl font-bold text-blue-700">åŸºçŸ³è®¡åˆ’</h2>
                    <p class="text-sm my-2">å®æ–½å…¨çƒç»Ÿä¸€çš„SAP R/3ç³»ç»Ÿï¼Œå®ç°ä¸šåŠ¡æµç¨‹æ ‡å‡†åŒ–ã€‚</p>
                    <p class="font-bold">ç›®æ ‡: é™ä½è¿è¥æˆæœ¬, ç»Ÿä¸€æ•°æ®ã€‚</p>
                </div>
                <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                    <h2 class="text-xl font-bold text-green-700">çªè§¦è®¡åˆ’</h2>
                    <p class="text-sm my-2">é€šè¿‡çŸ¥è¯†ç®¡ç†ç³»ç»Ÿï¼Œåº”å¯¹â€œå¤§æ¢ç­â€å¸¦æ¥çš„çŸ¥è¯†æµå¤±é£é™©ã€‚</p>
                    <p class="font-bold">ç›®æ ‡: ä¿ç•™æ ¸å¿ƒçŸ¥è¯†, åŸ¹è‚²åˆ†äº«æ–‡åŒ–ã€‚</p>
                </div>
                <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-200">
                    <h2 class="text-xl font-bold text-yellow-700">åœ°å¹³çº¿è®¡åˆ’</h2>
                    <p class="text-sm my-2">åˆ©ç”¨æ•°å­—æŠ€æœ¯æ‰“é€ â€œæ•°å­—æ²¹ç”°â€ï¼Œæé«˜ä¸Šæ¸¸èµ„äº§äº§é‡ä¸å®‰å…¨ã€‚</p>
                    <p class="font-bold">ç›®æ ‡: æé«˜é‡‡æ”¶ç‡, é™ä½æˆæœ¬ã€‚</p>
                </div>
            </div>
            
            <h2 class="text-xl font-bold text-blue-800 mt-8 mb-4">æˆ˜ç•¥ä¸¾æªï¼šé¢„ç®—ä¸æ—¶é—´çº¿æ¦‚è§ˆ (2000å¹´)</h2>
            <div class="chart-container">
                <canvas id="initiativesChart"></canvas>
            </div>
            
            <div class="mt-8 text-center">
                 <button id="future-view-btn" class="future-view-button">
                    ğŸš€ å±•æœ›æœªæ¥ï¼šä¸2025å¹´å¯¹æ¯”
                </button>
            </div>

            <div id="future-view-content" class="hidden mt-6 bg-gray-100 p-6 rounded-lg border border-gray-300">
                <h2 class="text-2xl font-bold text-purple-700 mb-4 text-center">æŠ€æœ¯æ ¼å±€ï¼š25å¹´å·¨å˜ (2000 vs 2025)</h2>
                <table class="w-full border-collapse">
                    <thead>
                        <tr class="bg-gray-200">
                            <th class="p-2 border">æŠ€æœ¯é¢†åŸŸ</th>
                            <th class="p-2 border">2000å¹´çŠ¶å†µ</th>
                            <th class="p-2 border font-bold text-purple-700">2025å¹´çŠ¶å†µ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td class="p-2 border font-bold">è®¡ç®—</td><td class="p-2 border">æœ¬åœ°æœåŠ¡å™¨, Sun E10000</td><td class="p-2 border">æ··åˆäº‘, è¾¹ç¼˜è®¡ç®—</td></tr>
                        <tr><td class="p-2 border font-bold">è½¯ä»¶</td><td class="p-2 border">å•ä½“å¼ERP, EAI</td><td class="p-2 border">SaaS, å¾®æœåŠ¡</td></tr>
                        <tr><td class="p-2 border font-bold">äººå·¥æ™ºèƒ½</td><td class="p-2 border">ä¸“å®¶ç³»ç»Ÿ, è§„åˆ™å¼•æ“</td><td class="p-2 border">ç”Ÿæˆå¼AI, å¤§è§„æ¨¡æœºå™¨å­¦ä¹ </td></tr>
                        <tr><td class="p-2 border font-bold">ç”¨æˆ·ç•Œé¢</td><td class="p-2 border">æ¡Œé¢ä¸ºä¸­å¿ƒ (800x600)</td><td class="p-2 border">ç§»åŠ¨ä¼˜å…ˆ, AR/VR</td></tr>
                    </tbody>
                </table>
            </div>

        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const desktop = document.getElementById('desktop');
            const windows = document.querySelectorAll('.window');
            let activeWindow = null;
            let highestZIndex = 500;

            function updateClock() {
                const now = new Date();
                const hours = now.getHours().toString().padStart(2, '0');
                const minutes = now.getMinutes().toString().padStart(2, '0');
                document.getElementById('clock').textContent = `${hours}:${minutes}`;
            }
            updateClock();
            setInterval(updateClock, 1000);

            function bringToFront(win) {
                if (activeWindow) {
                    activeWindow.classList.remove('active');
                    activeWindow.style.zIndex = parseInt(activeWindow.style.zIndex) - 100;
                }
                highestZIndex++;
                win.style.zIndex = highestZIndex;
                win.classList.add('active');
                activeWindow = win;
            }
            
            windows.forEach(win => {
                const titleBar = win.querySelector('.title-bar');
                const closeButton = win.querySelector('.close-button');
                let isDragging = false;
                let offsetX, offsetY;

                win.addEventListener('mousedown', () => bringToFront(win));

                titleBar.addEventListener('mousedown', (e) => {
                    isDragging = true;
                    offsetX = e.clientX - win.offsetLeft;
                    offsetY = e.clientY - win.offsetTop;
                    titleBar.style.cursor = 'grabbing';
                });

                document.addEventListener('mousemove', (e) => {
                    if (isDragging) {
                        let newX = e.clientX - offsetX;
                        let newY = e.clientY - offsetY;
                        
                        const desktopRect = desktop.getBoundingClientRect();
                        newX = Math.max(0, Math.min(newX, desktopRect.width - win.offsetWidth));
                        newY = Math.max(0, Math.min(newY, desktopRect.height - win.offsetHeight - 30));

                        win.style.left = `${newX}px`;
                        win.style.top = `${newY}px`;
                    }
                });

                document.addEventListener('mouseup', () => {
                    isDragging = false;
                    titleBar.style.cursor = 'move';
                });

                closeButton.addEventListener('click', (e) => {
                    e.stopPropagation();
                    win.style.display = 'none';
                });
            });

            function openWindow(windowId) {
                const win = document.getElementById(windowId);
                if (win) {
                    win.style.display = 'flex';
                    bringToFront(win);
                }
            }
            
            document.getElementById('icon-intranet').addEventListener('dblclick', () => openWindow('window-intranet'));
            document.getElementById('icon-sap').addEventListener('dblclick', () => openWindow('window-sap'));
            document.getElementById('icon-docs').addEventListener('dblclick', () => openWindow('window-docs'));
            
            document.getElementById('icon-intranet').addEventListener('click', () => openWindow('window-intranet'));
            document.getElementById('icon-sap').addEventListener('click', () => openWindow('window-sap'));
            document.getElementById('icon-docs').addEventListener('click', () => openWindow('window-docs'));


            const ctx = document.getElementById('initiativesChart').getContext('2d');
            const initiativesChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['åŸºçŸ³è®¡åˆ’ (ERP)', 'åœ°å¹³çº¿è®¡åˆ’ (æ•°å­—æ²¹ç”°)', 'çªè§¦è®¡åˆ’ (çŸ¥è¯†ç®¡ç†)'],
                    datasets: [{
                        label: 'é¢„è®¡é¢„ç®— (ç™¾ä¸‡ç¾å…ƒ)',
                        data: [200, 62.5, 15],
                        backgroundColor: ['#3b82f6', '#f59e0b', '#10b981'],
                        borderColor: ['#1d4ed8', '#b45309', '#047857'],
                        borderWidth: 1
                    },
                    {
                        label: 'é¢„è®¡æ—¶é—´çº¿ (å¹´)',
                        data: [4, 2.5, 2],
                         backgroundColor: ['#93c5fd', '#fcd34d', '#6ee7b7'],
                        borderColor: ['#3b82f6', '#f59e0b', '#10b981'],
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'é¡¹ç›®æŠ•èµ„ä¸å‘¨æœŸ (å¹³å‡ä¼°ç®—)',
                            font: { size: 16 }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.x !== null) {
                                        if(context.datasetIndex === 0) {
                                           label += new Intl.NumberFormat('zh-CN', { style: 'currency', currency: 'USD' }).format(context.parsed.x * 1000000);
                                        } else {
                                           label += context.parsed.x + ' å¹´';
                                        }
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'é¢„ç®— (ç™¾ä¸‡ç¾å…ƒ) / æ—¶é—´ (å¹´)'
                            }
                        }
                    }
                }
            });

            document.getElementById('future-view-btn').addEventListener('click', function() {
                const content = document.getElementById('future-view-content');
                content.classList.toggle('hidden');
            });
        });
    </script>
</body>
</html>
